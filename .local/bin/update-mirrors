#!/bin/sh
# update mirrors and database

TMP=$(mktemp)

notify-send -t 3000 "Update Mirrors" "Evaluating mirrors..."

rate-mirrors --save="$TMP" arch --max-delay=43200 &&
	notify-send -t 3000 "Update Mirrors" "Doas authentication required"

doas mv /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist-backup &&
	doas mv "$TMP" /etc/pacman.d/mirrorlist &&
	paru -Syy
