#!/bin/sh
# requires secli, xh, jql, wego, ipinfo.io token, owm api key

ipinfo_token=$(secli get ipinfo_token)

owm_api_key=$(secli get owm_api_key)

coordinates=$(xh -Fb "https://ipinfo.io/?token=$ipinfo_token" |
	jql -r '."loc"')

if [ $# -eq 0 ]; then
	wego -b openweathermap -owm-api-key "$owm_api_key" -l "$coordinates" -d 7 -u imperial
else
  wego -b openweathermap -owm-api-key "$owm_api_key" -l "$@" -d 7 -u imperial
fi
